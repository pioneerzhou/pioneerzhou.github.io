---
title: 'SAS学习笔记5-SAS函数'
date: 2024-05-20
permalink: /posts/2024/05/SASfunctions/
tags:
  - cool posts
  - guide
  - experience
  - learning
  - SAS
---

# SAS的变量、运算符与函数

## SAS变量

1. SAS变量的主要类型:数值型(Numeric)、字符型(Character)及日期型(Date)
2. SAS变量的命名规则与数据集命名规则相同
3. 缺失值(Missing value):当观测的某变量值未知时，在SAS系统中会记为缺失值。数值型变量用"."表示。在统计分析时，缺失值不参加运算。

### 如何给不同的类型变量赋值

1. 用`Input/Cards`语句
    - 数值型变量，直接赋值
    - 字符型变量，要在变量后加"\$"符号，如:`name$`
    - 日期型变量指定日期型变量的输入格式，如:`bdate YYMMDD8`
2. 用表达式
    - 数值型变量 `X=1.23;y=-5;z=0.5E-10`
  
## SAS运算符

SAS可以通过运算符产生新的变量

| 运算符号 | 含义          | 运算符号    | 含义                        |
|----------|--------------------------|-------------|-----------------------------|
| `+`      | 加法                     | `=`         | 等于                        |
| `-`      | 减法                     | `^=`        | 不等于                      |
| `*`      | 乘法                     | `!=`        | 不等于                      |
| `/`      | 除法                     | `~=`        | 不等于                      |
| `**`     | 乘方                     | `>`         | 大于                        |
| `AND`    | 逻辑与                   | `<`         | 小于                        |
| `OR`     | 逻辑或                   | `>=`        | 大于或等于                  |
| `NOT`    | 逻辑非                   | `<=`        | 小于或等于                  |
| `IN`     | 在某个值列表中            | `()`        | 括号                       |
| `=`      | 赋值                     | `^`         | 按位异或                    |
| `+`      | 一元加（正号）            | `&`         | 按位与                      |
| `-`      | 一元减（负号）            | `\|`        | 按位或                      |
| `~`      | 按位非                   | `<<`        | 左移                        |
| `>>`     | 右移                     | `^`         | 取幂（在某些场合）          |
| `+=`     | 加并赋值                 | `-=`        | 减并赋值                    |
| `*=`     | 乘并赋值                 | `/=`        | 除并赋值                    |
| `\|\|=`    | 字符串连接并赋值        |             |                             |

在一个算术表达式中，计算的优先顺序是括号、乘方、乘或除和加或减。

示例：

$y=\frac{\sqrt{7.9}+9}{(3.5-2.33)^2}$

在SAS中的实现程序为：

```sas
data c;
y = (7.9**0.5+8)/(3.5-2.33)**2;
proc print;
run;
```

## SAS函数

### SAS常用函数

| 函数类型       | 函数表达式                      | 函数含义                                    |
|----------------|-------------------------------|---------------------------------------------|
| 算术函数       | `ABS(x)`                       | 返回参数 x 的绝对值                          |
|                | `CEIL(x)`                     | 返回不小于参数 x 的最小整数                   |
|                | `FLOOR(x)`                    | 返回不大于参数 x 的最大整数                   |
|                | `ROUND(x)`                    | 返回参数 x 四舍五入后的整数值                 |
|                | `INT(x)`                      | 返回参数 x 的整数部分                         |
|                | `SIGN(x)`                     | 返回参数 x 的符号（1，0 或 -1）               |
|                | `MAX(x,y,...)`                | 返回x,y,...中的最大值                        |
|                | `MIN(x,y,...)`                | 返回x,y,...中的最小值                        |
| 截取函数        | `SUBSTR(string, start, length)`| 从字符串中截取子字符串                       |
|                | `LEFT(string, length)`        | 返回字符串左边的指定长度部分                  |
|                | `RIGHT(string, length)`       | 返回字符串右边的指定长度部分                  |
|                | `SCAN(string, n, delimiters)` | 返回字符串中第 n 个由分隔符分隔的单词          |
| 数学函数        | `LOG(x)`                      | 返回参数 x 的自然对数                        |
|                | `LOG10(x)`                    | 返回参数 x 的以 10 为底的对数                 |
|                | `EXP(x)`                      | 返回 e 的 x 次幂                            |
|                | `SQRT(x)`                     | 返回参数 x 的平方根                          |
|                | `POWER(x, y)`                 | 返回 x 的 y 次幂                            |
| 三角函数        | `SIN(x)`                      | 返回参数 x 的正弦值 (x为弧度)                |
|                | `COS(x)`                      | 返回参数 x 的余弦值                          |
|                | `TAN(x)`                      | 返回参数 x 的正切值                          |
|                | `ASIN(x)`                     | 返回参数 x 的反正弦值                        |
|                | `ACOS(x)`                     | 返回参数 x 的反余弦值                        |
|                | `ATAN(x)`                     | 返回参数 x 的反正切值                        |
| 概率分布函数    | `CDF(type, x, parameters)`    | 返回累积分布函数的值                        |
|                | `PDF(type, x, parameters)`    | 返回概率密度函数的值                        |
|                | `PDF('NORMAL', x, mean, std)`                 | 正态分布的概率密度函数，其中 mean 是均值，std 是标准差 |
|                | `PDF('POISSON', x, lambda)`                   | 泊松分布的概率密度函数，其中 lambda 是均值           |
|                | `PDF('BINOMIAL', x, n, p)`                    | 二项分布的概率密度函数，其中 n 是试验次数，p 是成功概率 |
|                | `PDF('CHISQ', x, df)`                         | 卡方分布的概率密度函数，其中 df 是自由度             |
|                | `PDF('T', x, df)`                             | t 分布的概率密度函数，其中 df 是自由度               |
| 随机函数        | `RAND('UNIFORM')`             | 返回 [0,1] 区间内的均匀分布随机数           |
|                | `RAND('NORMAL', mean, std)`   | 返回具有指定均值和标准差的正态分布随机数    |
|                | `RAND('BERNOULLI', p)`        | 返回以概率 p 抽取 1 的伯努利分布随机数      |
|                | `RAND('EXPONENTIAL', lambda)` | 返回具有指定指数参数的指数分布随机数        |
| 字符函数        | `UPCASE(string)`              | 将字符串中的字母转换为大写                 |
|                | `LOWCASE(string)`             | 将字符串中的字母转换为小写                 |
|                | `TRIM(string)`                | 去除字符串两端的空格                        |
|                | `CATX(separator, ...)`        | 将参数连接为一个字符串，并使用指定分隔符       |

### 函数运算示例

```sas
data d;
x1=log(2);
x2=log10(10);
x3=min(2,3,4,5);
x4=probnorm(-1.96);
proc print;
run;
```